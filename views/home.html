{% extends 'base.html' %}

{% block main %}
<div class="jumbotron">
    {% if user is not empty %}
        <div class="modal" tabindex="-1" id="message-information">
            <div class="modal-dialog modal-lg">
                <div class="modal-content">
                    <div class="modal-header">
                        <h4 class="modal-title">Message details - Message ID: <code><span id="message-id"></span></code></h4>
                        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                    </div>

                    <div class="modal-body">
                        <h3>User details:</h3>
                        <table class="table table-bordered table-hover table-striped" id="user">
                            <tbody>
                                <tr>
                                    <th>Name:</th>
                                    <td id="name"></td>
                                </tr>

                                <tr>
                                    <th>User ID:</th>
                                    <td id="user_id"></td>
                                </tr>

                                <tr>
                                    <th class="align-middle">Avatar:</th>
                                    <td><img src="" id="avatar" /></td>
                                </tr>

                                <tr>
                                    <th>Created at:</th>
                                    <td id="created_at"></td>
                                </tr>

                                <tr>
                                    <th>Bot</th>
                                    <td id="bot"></td>
                                </tr>
                            </tbody>
                        </table>

                        <h3>Message details:</h3>
                        <table class="table table-bordered table-hover table-striped" id="message">
                            <tbody>
                                <tr>
                                    <th>Content:</th>
                                    <td><pre id="content" class="pre-message"></pre></td>
                                </tr>
                                <tr>
                                    <th>Message sent/updated:</th>
                                    <td id="updated_at"></td>
                                </tr>
                            </tbody>
                        </table>

                        <div id="attachments" class="d-none">
                            <h3>Attachment details:</h3>
                            <table class="table table-bordered table-hover table-striped">
                                <thead>
                                    <tr>
                                        <th>Filename:</th>
                                        <th>File URL:</th>
                                    </tr>
                                </thead>

                                <tbody></tbody>
                            </table>
                        </div>
                    </div>

                    <div class="modal-footer">
                        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="form-group">
            <button type="button" class="btn btn-success disabled" id="refresh">
                <i class="fas fa-1x fa-spinner"></i> Refresh
            </button>
        </div>

        <br>

        <div class="form-group">
            <label for="channel"><i class="fas fa-fw fa-1x fa-list"></i> Channel:</label>
            <select class="form-control" id="channel">
                <option selected="" value="">Select channel</option>
            </select>
        </div>

        <div class="form-group">
            <label for="user"><i class="fas fa-fw fa-1x fa-search"></i> User ID:</label>
            <input type="text" class="form-control" id="userid" />
        </div>

        <div class="form-group">
            <label for="limit"><i class="fas fa-fw fa-1x fa-sort-numeric-up-alt"></i> Maximum number of messages:</label>
            <input type="number" class="form-control" step="1" min="1" value="25" id="limit">
        </div>

        <div class="form-group">
            <label for="offset"><i class="fas fa-fw fa-1x fa-sort-numeric-down-alt"></i> Amount of messages to offset by:</label>
            <input type="number" class="form-control" step="1" min="0" value="0" id="offset">
        </div>

        <div class="alert alert-danger d-none" id="error"></div>

        <div class="d-none alert alert-success"><i class="fas fa-fw fa-1x fa-comments"></i> Retrieved <strong id="count"></strong> messages</div>
        <button class="btn btn-xs btn-info d-none" id="info-btn"><i class="fa fa-1x fa-info"></i></button>
        <table id="messages" class="table table-bordered d-none">
            <thead>
                <tr>
                    <th>Date &amp; time:</th>
                    <th>Channel:</th>
                    <th>Display name:</th>
                    <th>Message:</th>
                    <th>Actions:</th>
                </tr>
            </thead>

            <tbody></tbody>
        </table>
    {% else %}
        <h4 class="text-info">Please <a href="/auth/discord">log in with <i class="fab fa-1x fa-discord"></i> Discord</a>.</h4>
    {% endif %}
</div>
{% endblock %}

{% block scripts %}
    {% if user is not empty %}
        <script type="text/javascript" src="/static/js/messages.js"></script>
    {% endif %}
{% endblock %}
